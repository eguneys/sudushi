var Space=function(){"use strict";const t={equals:(t,e)=>t===e};let e=M;const n={},r={t:null,i:null,context:null,u:null};a(!1);var i=null;let s=null,u=null,o=null,h=null,l=0;function c(t){const e=s,n=i,u=0===t.length?r:{t:null,i:null,context:null,u:n};i=u,s=null;try{return p((()=>t((()=>A(u)))),!0)}finally{s=e,i=n}}function a(e,r){r=r?Object.assign({},t,r):t;const i={value:e,o:null,h:null,pending:n,l:r.equals||void 0};return[v.bind(i),t=>("function"==typeof t&&(t=t(i.pending!==n?i.pending:i.value)),m(i,t))]}function f(t,e,n){w(y(t,e,!1,1))}function g(t,n,r){e=I;const i=y(t,n,!1,1);i.g=!0,h?h.push(i):queueMicrotask((()=>w(i)))}function d(e,r,i){i=i?Object.assign({},t,i):t;const s=y(e,r,!0,0);return s.pending=n,s.o=null,s.l=i.equals||void 0,w(s),v.bind(s)}function v(){if(this.sources&&this.state){const t=o;o=null,1===this.state?w(this):b(this),o=t}if(s){const t=this.o?this.o.length:0;s.sources?(s.sources.push(this),s.v.push(t)):(s.sources=[this],s.v=[t]),this.o?(this.o.push(s),this.h.push(s.sources.length-1)):(this.o=[s],this.h=[s.sources.length-1])}return this.value}function m(t,e,r){return u?(t.pending===n&&u.push(t),t.pending=e,e):(t.l&&t.l(t.value,e)||(t.value=e,t.o&&t.o.length&&p((()=>{for(let e=0;e<t.o.length;e+=1){const n=t.o[e];n.state||(n.m?o.push(n):h.push(n),n.o&&U(n)),n.state=1}if(o.length>1e6)throw o=[],new Error}),!1)),e)}function w(t){if(!t.p)return;A(t);const e=i,n=s,r=l;s=i=t,function(t,e,n){let r;try{r=t.p(e)}catch(t){q(t)}(!t._||t._<=n)&&(t.o&&t.o.length?m(t,r):t.value=r,t._=n)}(t,t.value,r),s=n,i=e}function y(t,e,n,s=1,u){const o={p:t,state:s,_:null,t:null,sources:null,v:null,i:null,value:e,u:i,context:null,m:n};return null===i||i!==r&&(i.t?i.t.push(o):i.t=[o]),o}function p(t,n){if(o)return t();let r=!1;n||(o=[]),h?r=!0:h=[],l++;try{return t()}catch(t){q(t)}finally{!function(t){o&&(M(o),o=null);if(t)return;h.length?x((()=>{e(h),h=null})):h=null}(r)}}function x(t){if(u)return t();let e;const r=u=[];try{e=t()}finally{u=null}return p((()=>{for(let t=0;t<r.length;t+=1){const e=r[t];if(e.pending!==n){const t=e.pending;e.pending=n,m(e,t)}}}),!1),e}function _(t){if(0===t.state)return;if(2===t.state)return b(t);const e=[t];for(;(t=t.u)&&(!t._||t._<l);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(1===(t=e[n]).state)w(t);else if(2===t.state){const n=o;b(t,e[0]),o=n}}function M(t){for(let e=0;e<t.length;e++)_(t[e])}function b(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const r=t.sources[n];r.sources&&(1===r.state?r!==e&&_(r):2===r.state&&b(r,e))}}function A(t){let e;if(t.sources)for(;t.sources.length;){const e=t.sources.pop(),n=t.v.pop(),r=e.o;if(r&&r.length){const t=r.pop(),i=e.h.pop();n<r.length&&(t.v[i]=n,r[n]=t,e.h[n]=i)}}if(t.t){for(e=0;e<t.t.length;e++)A(t.t[e]);t.t=null}if(t.i){for(e=0;e<t.i.length;e++)t.i[e]();t.i=null}t.state=0,t.context=null}function q(t){throw t}function $(t){let e;return void 0!==(e=k(i,t.id))?e:t.defaultValue}function k(t,e){return t?t.context&&void 0!==t.context[e]?t.context[e]:k(t.u,e):void 0}function T(t){return function(e){let n;var r,s;return r=()=>n=z((()=>(i.context={[t]:e.value},function(t){const e=d(t);return d((()=>F(e())))}((()=>e.children))))),w(y(r,s,!0,void 0)),n}}function F(t){if("function"==typeof t&&!t.length)return F(t());if(Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++){const r=F(t[n]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return e}return t}function z(t){let e,n=s;return s=null,e=t(),s=n,e}function I(t){let e,n=0;for(e=0;e<t.length;e++){const r=t[e];r.g?t[n++]=r:_(r)}const r=t.length;for(e=0;e<n;e++)_(t[e]);for(e=r;e<t.length;e++)_(t[e])}function C(t,e,n){const r=Array.isArray(t);let i;return s=>{let u,o=n&&n.defer;if(r){u=[];for(let e=0;e<t.length;e++)u.push(t[e]())}else u=t();if(o)return void(o=!1);const h=z((()=>e(u,i,s)));return i=u,h}}function U(t){for(let e=0;e<t.o.length;e+=1){const n=t.o[e];n.state||(n.state=2,n.m?o.push(n):h.push(n),n.o&&U(n))}}function j(t){for(let e=0;e<t.length;e++)t[e]()}function D(t,e,n={}){let r=[],s=[],u=[],o=0,h=e.length>1?[]:null;var l;return l=()=>j(u),null===i||(null===i.i?i.i=[l]:i.i.push(l)),()=>{let i,l,f=t()||[];return z((()=>{let t,e,a,d,v,m,w,y,p,x=f.length;if(0===x)0!==o&&(j(u),u=[],r=[],s=[],o=0,h&&(h=[])),n.fallback;else if(0===o){for(s=new Array(x),l=0;l<x;l++)r[l]=f[l],s[l]=c(g);o=x}else{for(a=new Array(x),d=new Array(x),h&&(v=new Array(x)),m=0,w=Math.min(o,x);m<w&&r[m]===f[m];m++);for(w=o-1,y=x-1;w>=m&&y>=m&&r[w]===f[y];w--,y--)a[y]=s[w],d[y]=u[w],h&&(v[y]=h[w]);for(t=new Map,e=new Array(y+1),l=y;l>=m;l--)p=f[l],i=t.get(p),e[l]=void 0===i?-1:i,t.set(p,l);for(i=m;i<=w;i++)p=r[i],l=t.get(p),void 0!==l&&-1!==l?(a[l]=s[i],d[l]=u[i],h&&(v[l]=h[i]),l=e[l],t.set(p,l)):u[i]();for(l=m;l<x;l++)l in a?(s[l]=a[l],u[l]=d[l],h&&(h[l]=v[l],h[l](l))):s[l]=c(g);s=s.slice(0,o=x),r=f.slice(0)}return s}));function g(t){if(u[l]=t,h){const[t,n]=a(l);return h[l]=n,e(f[l],t)}return e(f[l])}}}function P(t,e){return z((()=>t(e)))}function S(t){return d(D((()=>t.M),t.children))}class O{constructor(t,e,n){this.A=t,this.width=e,this.height=n,this.q=document.createElement("canvas"),this.q.width=e,this.q.height=n,t.appendChild(this.q);let r=this.q.getContext("webgl2",{alpha:!0,antialias:!1});null!==r&&(this.$=r),this.q.addEventListener("webglcontextlost",(t=>{console.log("context lost"),t.preventDefault(),this.$=void 0})),this.q.addEventListener("webglcontextrestored",(()=>{console.log("restored"),null!==r&&(this.$=r)}))}}class R{constructor(t,e,n){this.k=t,this.T=e,this.F=n}}function B(t,e,n){const r=V(t,t.VERTEX_SHADER,e),i=V(t,t.FRAGMENT_SHADER,n),s=t.createProgram();t.attachShader(s,r),t.attachShader(s,i),t.linkProgram(s),t.getProgramParameter(s,t.LINK_STATUS)||function(t,e,n,r){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||E(t,n),t.getShaderParameter(r,t.COMPILE_STATUS)||E(t,r),console.error("Iksir: Couldn't initialize shader"),""!==t.getProgramInfoLog(e)&&console.warn("Iksir: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,s,r,i);let u=function(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=t.getActiveAttrib(e,i);if(0===r.name.indexOf("gl_"))continue;const s={I:"tpe",name:r.name,size:0,location:i};n[r.name]=s}return n}(t,s),o=function(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){const r=t.getActiveUniform(e,i),s={name:r.name,location:-1,index:i};n[r.name]=s}return n}(t,s);const h=Object.keys(u);for(let e=0;e<h.length;e++)u[h[e]].location=e,t.bindAttribLocation(s,e,h[e]);t.linkProgram(s),t.deleteShader(r),t.deleteShader(i);for(let e in o)o[e],o[e].location=t.getUniformLocation(s,e);return new R(o,u,s)}function V(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}function E(t,e){const n=t.getShaderSource(e).split("\n").map(((t,e)=>`${e}: ${t}`)),r=t.getShaderInfoLog(e),i=r.split("\n"),s={},u=i.map((t=>parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1")))).filter((t=>!(!t||s[t])&&(s[t]=!0,!0))),o=[""];u.forEach((t=>{n[t-1]=`%c${n[t-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));const h=n.join("\n");o[0]=h,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}class L{constructor(t,e){this.quad=t,this.tint=e}}class G{get C(){return this.U||(this.U=[this,...this.j.flatMap((t=>t.C))]),this.U}constructor(t=[],e=K.unit,n=K.unit){this.j=t,this.D=e,this.P=n}get quad(){return this.S?.quad}get tint(){return this.O}set quad(t){this.S=new L(t,this.O)}O=16777215;set tint(t){this.O=t,this.S&&(this.S.tint=t)}size=H.unit;pivot=H.R;scale=H.unit;rotation=0;translate=H.R;get clone(){let t=new G([],this.D.clone,this.P.clone);return this.j.forEach((e=>e.clone.B(t))),t.size=this.size.clone,t.pivot=this.pivot.clone,t.scale=this.scale.clone,t.rotation=this.rotation,t.translate=this.translate.clone,t.quad=this.quad,t.tint=this.tint,t.V(),t.L(),t}get G(){let{size:t,scale:e,rotation:n,translate:r,pivot:i}=this,s=e.mul(t);return this.P.H(s,n,r,i),this.P}get x(){return this.translate.x}set x(t){this.translate.J(t,this.y)}get y(){return this.translate.y}set y(t){this.translate.J(this.x,t)}V(){let t=this;do{t.U=void 0}while(t=t.K)}N(){this.j.forEach((t=>t.parent=void 0)),this.j.splice(0),this.V()}B(t){t.j.push(this),this.K=t,this.V()}get W(){return this.K.j[this.K.j.indexOf(this)+1]}get X(){return this.j[0]}Y(t,e){if(t===e)return;t.Z();let n=this.j.indexOf(e);-1===n&&(n=this.j.length),this.j.splice(n,0,t),t.K=this,t.V()}tt(t,e){t.Z(),this.j.splice(this.j.indexOf(e),1,t),e.K=void 0,t.K=this,t.V()}Z(){this.K&&(this.K.j.splice(this.K.j.indexOf(this),1),this.K.V(),this.K=void 0)}L(t){t?(this.D.J(t),this.D.et(this.G)):this.D.J(this.G);let{D:e}=this;this.j.forEach((t=>t.L(e)))}}class H{static nt=t=>new H(Math.cos(t),Math.sin(t));static rt=(t,e)=>new H(t,e);static get unit(){return new H(1,1)}static get R(){return new H(0,0)}get it(){return[this.x,this.y]}get st(){return new H(1/this.x,1/this.y)}get ut(){return new H(-this.x,-this.y)}get ot(){return new H(this.x/2,this.y/2)}get length(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalize(){return 0===this.length?H.R:this.scale(1/this.length)}get clone(){return new H(this.x,this.y)}get angle(){return Math.atan2(this.y,this.x)}constructor(t,e){this.x=t,this.y=e}ht(t){return this.sub(t).length}lt(t){return H.rt(this.x,this.y+t)}ct(t){return H.nt(this.angle+t)}scale(t){return H.rt(this.x*t,this.y*t)}add(t){let{clone:e}=this;return e.ft(t),e}ft(t){this.x+=t.x,this.y+=t.y}sub(t){let{clone:e}=this;return e.gt(t),e}gt(t){this.x-=t.x,this.y-=t.y}mul(t){let{clone:e}=this;return e.et(t),e}et(t){this.x*=t.x,this.y*=t.y}div(t){let{clone:e}=this;return e.dt(t),e}dt(t){this.x/=t.x,this.y/=t.y}J(t,e=t){this.x=t,this.y=e}}class J{static rt=(t,e,n,r)=>new J([H.rt(t,e),H.rt(t+n,e),H.rt(t+n,e+r),H.rt(t,e+r)]);static get unit(){return J.rt(0,0,1,1)}get it(){let{x:t,y:e,w:n,vt:r}=this;return[t,e,n,r]}get x1(){return this.wt[0].x}get y1(){return this.wt[0].y}get x2(){return this.wt[2].x}get y2(){return this.wt[2].y}get x(){return this.x1}get y(){return this.y1}get w(){return this.x2-this.x1}get vt(){return this.y2-this.y1}get yt(){return new Float32Array(this.wt.flatMap((t=>t.it)))}get xt(){return new Uint16Array([0,1,2,0,2,3])}constructor(t){this.wt=t}transform(t){return new J(this.wt.map((e=>t._t(e))))}}class K{static get identity(){return new K(1,0,0,1,0,0)}static get unit(){return K.identity}static Mt=(t,e)=>new K(1/t*2,0,0,-1/e*2,-1,1);get clone(){let{a:t,b:e,c:n,d:r,bt:i,At:s}=this;return new K(t,e,n,r,i,s)}get inverse(){let{a:t,b:e,c:n,d:r,bt:i,At:s}=this,u=t*r-e*n;return new K(r/u,-e/u,-n/u,t/u,(n*s-r*i)/u,-(t*s-e*i)/u)}constructor(t,e,n,r,i,s){this.a=t,this.b=e,this.c=n,this.d=r,this.bt=i,this.At=s,this.qt=new Float32Array([t,e,0,n,r,0,i,s,1])}$t(t){let e=Math.cos(t),n=Math.sin(t),r=this.a*e-this.b*n,i=this.a*n+this.b*e,s=this.c*e-this.d*n,u=this.c*n+this.d*e,o=this.bt*e-this.At*n,h=this.bt*n+this.At*e;this.a=r,this.b=i,this.c=s,this.d=u,this.bt=o,this.At=h}rotate(t){let{clone:e}=this;return e.$t(t),e}scale(t,e){let n=this.a*t,r=this.b,i=this.c,s=this.d*e,u=this.bt,o=this.At;return new K(n,r,i,s,u,o)}kt(t,e){this.a,this.b,this.c,this.d;let n=t+this.bt,r=e+this.At;this.bt=n,this.At=r}translate(t,e){let{clone:n}=this;return n.kt(t,e),n}Tt(t,e){this.a=t,this.d=e}_t(t){let e=this.a,n=this.b,r=this.c,i=this.d,s=this.bt,u=this.At,o=e*t.x+r*t.y+s,h=n*t.x+i*t.y+u;return H.rt(o,h)}et(t){let{a:e,b:n,c:r,d:i,bt:s,At:u}=this;this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*i,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*i,this.bt=t.bt*e+t.At*r+s,this.At=t.bt*n+t.At*i+u}J(t){let{a:e,b:n,c:r,d:i,bt:s,At:u}=t;this.a=e,this.b=n,this.c=r,this.d=i,this.bt=s,this.At=u}H(t,e,n,r=H.ot){this.a=Math.cos(e)*t.x,this.b=Math.sin(e)*t.x,this.c=-Math.sin(e)*t.y,this.d=Math.cos(e)*t.y,this.bt=n.x-(r.x*this.a+r.y*this.c),this.At=n.y-(r.x*this.b+r.y*this.d)}}function N(t){return[(16711680&t)>>16,(65280&t)>>8,255&t].map((t=>t/255))}class Q{get $(){return this.canvas.$}get width(){return this.canvas.width}get height(){return this.canvas.height}constructor(t){this.canvas=t,this.projectionMatrix=K.Mt(this.width,this.height)}Ft=(t={})=>{let{$:e}=this;if(!e)return;let{color:n}=t;e.viewport(0,0,this.width,this.height),e.clearColor(...N(n||0),1),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA)};zt=(t,e,n)=>{let{$:r}=this,{F:i,k:s,T:u}=B(r,t,e),o=r.createVertexArray();r.bindVertexArray(o);let h=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,h),r.bufferData(r.ARRAY_BUFFER,6*n*4,r.DYNAMIC_DRAW);let l=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,l),r.bufferData(r.ELEMENT_ARRAY_BUFFER,3*n*4,r.DYNAMIC_DRAW);let c=u.aVertexPosition.location;r.enableVertexAttribArray(c),r.vertexAttribPointer(c,2,r.FLOAT,!1,28,0);let a=u.aTextureCoord.location;r.enableVertexAttribArray(a),r.vertexAttribPointer(a,2,r.FLOAT,!1,28,8);let f=u.aTint.location;return r.enableVertexAttribArray(f),r.vertexAttribPointer(f,3,r.FLOAT,!1,28,16),r.bindVertexArray(null),{F:i,k:s,It:l,Ct:h,Ut:o}};jt(){let{$:t}=this,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([0,0,255,255])),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),{jt:e}}Dt(t,e){let{$:n}=this;n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,e)}Pt(t,e){let{$:n}=this;n.useProgram(t),n.uniformMatrix3fv(e.projectionMatrix.location,!1,this.projectionMatrix.qt)}St(t,e){}Ot(t,e){let{$:n}=this;n.bindBuffer(n.ARRAY_BUFFER,t),n.bufferSubData(n.ARRAY_BUFFER,0,e,0)}Rt(t,e){let{$:n}=this;n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),n.bufferSubData(n.ELEMENT_ARRAY_BUFFER,0,e,0)}Bt(){let{$:t}=this;t.clear(t.COLOR_BUFFER_BIT)}Vt(t,e){let{$:n}=this;n.bindVertexArray(e),n.drawElements(n.TRIANGLES,t,n.UNSIGNED_SHORT,0)}}class W{static rt=(t,e,n,r=t.width,i=t.height)=>new W(t,J.rt(e,n,r,i));get w(){return this.Et.w}get vt(){return this.Et.vt}get Lt(){return this.frame.x}get Gt(){return this.frame.y}get x1(){return this.frame.x2}get y1(){return this.Gt}get x2(){return this.x1}get y2(){return this.frame.y2}get Ht(){return this.Lt}get Jt(){return this.y2}constructor(t,e){this.Kt=t,this.Et=e,this.Nt=t.width,this.Qt=t.height,this.frame=e.transform(K.unit.scale(1/this.Nt,1/this.Qt)),this.Wt=new Float32Array([this.Lt,this.Gt,this.x1,this.y1,this.x2,this.y2,this.Ht,this.Jt])}}function X(t,e){return new G}function Y(t,e,n){t[e]=null==n?void 0:n}function Z(t,e,n,r){if(void 0===n||r||(r=[]),"function"!=typeof e)return tt(t,e,r,n);f((r=>tt(t,e(),r,n)),r)}function tt(t,e,n,r,i){for(;"function"==typeof n;)n=n();if(e===n)return n;const s=typeof e,u=void 0!==r;if(t=u&&n[0]&&n[0].K||t,null==e)n=rt(t,n,r);else{if("function"===s)return f((()=>{let i=e();for(;"function"==typeof i;)i=i();n=tt(t,i,n,r)})),()=>n;if(Array.isArray(e)){const s=[];if(et(s,e,i))return f((()=>n=tt(t,s,n,r,!0))),()=>n;if(0===s.length){if(n=rt(t,n,r),u)return n}else Array.isArray(n)?0===n.length?nt(t,s):function(t,e,n){let r=n.length,i=e.length,s=r,u=0,o=0,h=e[i-1].W,l=null;for(;u<i||o<s;)if(e[u]!==n[o]){for(;e[i-1]===n[s-1];)i--,s--;if(i===u){const e=s<r?o?n[o-1].W:n[s-o]:h;for(;o<s;)t.Y(n[o++],e)}else if(s===o)for(;u<i;)l&&l.has(e[u])||e[u].Z(),u++;else if(e[u]===n[s-1]&&n[o]===e[i-1]){const r=e[--i].W;t.Y(n[o++],e[u++].W),t.Y(n[--s],r),e[i]=n[s]}else{if(!l){l=new Map;let t=o;for(;t<s;)l.set(n[t],t++)}const r=l.get(e[u]);if(null!=r)if(o<r&&r<s){let h,c=u,a=1;for(;++c<i&&c<s&&null!=(h=l.get(e[c]))&&h===r+a;)a++;if(a>r-o){const i=e[u];for(;o<r;)t.Y(n[o++],i)}else t.tt(n[o++],e[u++])}else u++;else e[u++].Z()}}else u++,o++}(t,n,s):(n&&rt(t),nt(t,s));n=s}else if(e instanceof G){if(Array.isArray(n)){if(u)return n=rt(t,n,r,e);rt(t,n,null,e)}else null!==n&&t.X?t.tt(e,t.X):e.B(t);n=e}}return n}function et(t,e,n){let r=!1;for(let i=0,s=e.length;i<s;i++){let s=e[i];if(s instanceof G)t.push(s);else if(null==s||!0===s||!1===s);else if(Array.isArray(s))r=et(t,s)||r;else if("function"==typeof s)if(n){for(;"function"==typeof s;)s=s();r=et(t,Array.isArray(s)?s:[s])||r}else t.push(s),r=!0}return r}function nt(t,e,n){for(let n=0,r=e.length;n<r;n++)e[n].B(t)}function rt(t,e,n,r){if(void 0===n)return t.N()&&t.j;const i=r||[];if(e.length){let r=!1;for(let s=e.length-1;s>=0;s--){const u=e[s];if(i!==u){const e=u.K===t;r||s?e&&u.Z():e?t.tt(i,u):t.Y(i,n)}else r=!0}}else t.Y(i,n);return[i]}const it=1e3/60,st={Xt:60*it,ot:30*it,Yt:20*it,Zt:15*it,te:10*it,ee:5*it,ne:50,re:1*it};class ut{ie=0;se=0;get bounds(){return this.ue||(this.ue=this.q.getBoundingClientRect()),this.ue}get oe(){return this.ie}get he(){if(this.le?.move)return this.le}get click(){if(!this.le?.move&&this.le?.ce)return this.le.ce}get ae(){if(0===this.le?.button)return this.click}get fe(){if(2===this.le?.button)return this.click}get ge(){if(!this.de&&this.le&&!this.le?.move&&!this.le?.ce)return this.le.start}get ve(){if(!this.le)return this.me}get we(){if(this.le?.move)return[this.le.move[0]-this.le.start[0],this.le.move[1]-this.le.start[1]]}constructor(t){this.q=t}ye(t){let e=function(t){return void 0!==t.clientX&&void 0!==t.clientY?[t.clientX,t.clientY]:t.targetTouches?.[0]?[t.targetTouches[0].clientX,t.targetTouches[0].clientY]:void 0}(t),{bounds:n}=this,r=320/n.width,i=180/n.height;return e&&(e[0]-=n.left,e[1]-=n.top,e[0]*=r,e[1]*=i),e}pe=[];xe(){this.pe.forEach((t=>t()))}init(){let{q:t,pe:e}=this;t.addEventListener("wheel",(t=>{this.ie=Math.sign(t.deltaY)})),t.addEventListener("mousedown",(t=>{this.le||(this._e={button:t.button,start:this.ye(t)})})),t.addEventListener("mousemove",(t=>{this.le?this.le.Me=this.ye(t):this.me=this.ye(t)})),t.addEventListener("contextmenu",(t=>{t.preventDefault(),this.le||(this._e={button:t.button,start:this.ye(t)})}));let n=t=>{this.le&&(this.le.ce=this.ye(t),this.be=this.le)};document.addEventListener("mouseup",n),e.push((()=>document.removeEventListener("mouseup",n)));const r=()=>{this.ue=void 0};return window.addEventListener("resize",r),document.addEventListener("scroll",r),e.push((()=>window.removeEventListener("resize",r))),e.push((()=>document.removeEventListener("scroll",r))),this}update(t,e){this.se===this.ie?this.ie=0:this.se=this.ie,this.le&&(this.le.Ae=this.le.move,void 0!==this.le.Me&&(this.le.move||function(t,e){let n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)>3}(this.le.Me,this.le.start))&&(this.le.move=this.le.Me),this.be?this.be=void 0:this.le.ce&&(this._e=void 0)),this.de=this.le,this._e!==this.le&&(this.le=this._e)}}const ot=function(t){const e=Symbol("context");return{id:e,qe:T(e),defaultValue:t}}({}),ht=t=>{const[e,n]=a(),[r,i]=a(),[s,u]=a([16,16],{equals:!1}),[o,h]=a(new ut(t.q).init(),{equals:!1}),[l,c]=a(void 0,{equals:!1});let f=[{$e:e,root:r,update:s,ke:l,Te:o},{Fe:n,ze:i}];return function(t){let e,n,r=1e3/60,i=r;e=requestAnimationFrame((function s(u){let o=n?u-n:r;o=Math.min(33.333333333333336,Math.max(16.666666666666668,o)),t(o,i),i=o,n=u,e=requestAnimationFrame(s)}))}(((t,e)=>{u([t,e]),h((n=>(n.update(t,e),n))),c()})),P(ot.qe,{value:f,get children(){return t.children}})},lt=()=>$(ot);function ct(t,e){if("function"==typeof e)return t[1](e);t[1]((t=>e))}function at(t,e){return t[1]((t=>(e(t),t)))}function ft(t){return Array.isArray(t)?t[0]():t()}const gt=(()=>{let t=0;return()=>++t})();function dt(t,e){return`${t} ${e} ${gt()}`}function vt(t){return t.split(" ").map((t=>parseFloat(t)))}const mt=dt(0,0),wt=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","!","0","1","2","3","4","5","6","7","8","9",",","."];function yt(t){return t.split("").map((t=>wt.indexOf(t)))}class pt{get Ie(){return this.Ce.values}get Ue(){return this.je.values}constructor(){this.cursor=function(){const[{Te:t,update:e}]=lt();let n=_t(0,0),r=_t(0,0),i=_t(0,0);return g(C(e,(()=>{let{ve:e,ae:s,fe:u}=t();e&&x((()=>{n.x=e[0],n.y=e[1]})),s&&x((()=>{r.x=s[0],r.y=s[1]})),u&&x((()=>{i.x=u[0],i.y=u[1]}))}))),{De:n,click:r,fe:i}}(),this.Pe=function(t){let e=_t(100,100),n=_t(100,100),r=.91,i=Mt(100,1e3,r),s=Mt(100,1e3,r),u=function(t){let e=a(0);return{get value(){return ft(e)},Se(){ct(e,(e=>(e+1)%t))}}}(7),o=Ct([],xt),h=d((()=>o.head));g((()=>{let t=h();t&&(n.x=t.De.x,n.y=t.De.y)}));let l=d((()=>n.Oe().sub(e.Oe()).normalize)),c=d((()=>e.Oe().ht(n.Oe()))),f=d((()=>c()<8)),v=d((()=>e.Oe().add(l().scale(10))));return g(C(f,(t=>{g(C($t(1.5*st.ee),(()=>{g(C(kt(st.ne),(t=>{-1===t?(i.force=0,s.force=0,u.Se()):(i.force=.5*l().x*2,s.force=.5*l().y*2)})))})))}))),g((()=>{e.x=i.x,e.y=s.x})),g((()=>{let e=dt(...t.cursor.click.Oe().it);e!==mt&&o.Re(e)})),g(C(t.cursor.fe.Oe,(()=>{o.clear()}))),{get Be(){return v()},get frame(){return u.value},get direction(){return l()},get angle(){return l().angle},get Ue(){return guns.values},Ve:c,Ee:f,De:e,target:n,get Le(){return o.values}}}(this),this.Ce=Ct([],(t=>function(t,e,n){let[{update:r}]=lt(),i=_t(...vt(n)),s=Mt(vt(n)[0],1e3,.92),u=Mt(vt(n)[1],1e3,.92),o=d((()=>e.Pe.De.Oe().sub(i.Oe()).normalize));g(C($t(st.Xt),(()=>{g(C(kt(st.te),(t=>{x(-1===t?()=>{s.force=0,u.force=0}:()=>{s.force=.5*o().x,u.force=.5*o().y})})))}))),g(C(r,(()=>{i.x=s.x,i.y=u.x})));let h=Tt(st.ot,4,0);return{De:i,get tint(){return h()},Ge(){t()}}}((t=>this.Ce.remove(t)),this,t))),this.je=Ct([],(e=>function(t,e,n){let r=_t(...vt(e)),i=Mt(r.x,1e3,.92),s=Mt(r.y,1e3,.92),u=zt(1,0,st.Xt-st.Yt),o=H.rt(...vt(n)),h=.8;return g(C(kt(st.Xt),(e=>{-1===e?(i.force=0,s.force=0,t()):(i.force=o.x*u.value*2*h,s.force=o.y*u.value*2*h)}))),g((()=>{r.x=i.x,r.y=s.x})),{get angle(){return o.angle},De:r,He(){}}}((()=>this.je.remove(e)),dt(...t.Be.it),e))),this.level=function(t,e){let n=a(e),r=d((()=>"level "+It(ft(n))));return{get Je(){return ft(n)},Ke(){ct(n,(t=>Math.min(10,t+1)))},reset(){ct(n,0)},Ne:d(D((()=>yt(r())),bt))}}(0,0),this.Qe=function(t,e){let n=a(e),r=d((()=>"health "+It(ft(n))));return{We:d(D((()=>yt(r())),bt)),Xe(){ct(n,(t=>Math.max(0,t-1)))},max(){ct(n,Ut)},Ye(){ct(n,(t=>Math.min(Ut,t+2.5)))}}}(0,8),this.status=function(t){let e=a(""),n=d((()=>ft(e)));return{Ze:d(D((()=>yt(n())),bt)),set status(t){ct(e,t)}}}(),this.status.status="click around to move";let{Pe:t,cursor:e}=this;const n=t=>{this.je.push(t)};d((()=>{this.Ue.map((t=>{this.Ie.forEach((e=>{var n,r;n=e.De.Oe(),r=t.De.Oe(),n.ht(r)<8&&(t.He(e),e.Ge(t))}))}))}));let r=0;setInterval((()=>{for(let e=0;e<10;e++){let i=e/10*Math.PI*.01,s=t.direction.ct(i+Math.sin(30*r)*Math.PI*.08);r+=3e-4*Math.PI,n(dt(s.x,s.y))}}),100),setInterval((()=>{this.Ce.push(dt(320*Math.random(),180*Math.random()))}),940),setInterval((()=>{this.level.Ke()}),500),setInterval((()=>{this.level.reset()}),5e3),setInterval((()=>{this.Qe.Xe()}),600),setInterval((()=>{this.Qe.max()}),5e3)}}function xt(t){return{De:_t(...vt(t))}}function _t(t,e){let n=a(t,{equals:!1}),r=a(e,{equals:!1}),i=d((()=>dt(ft(n),ft(r))));return{get tn(){return i()},Oe:d((()=>H.rt(...vt(i())))),get x(){return ft(n)},set x(t){ct(n,t)},get y(){return ft(r)},set y(t){ct(r,t)}}}function Mt(t,e,n){let r,[{update:i}]=lt(),s=a(0),u=d((()=>ft(s)/e)),o=d(C(i,(([t,e])=>(r?.()??0)*n*t/e+u()*t*(t+e)/2))),h=d((t=>t+o()),t);return r=d(C(h,((e,n)=>e-(n??t)))),{get x(){return h()},get en(){return o()},set force(t){ct(s,t)},get debug(){return[ft(s),r()]}}}function bt(t){let e=Tt(st.Yt,12336731,16777215);return{frame:t,get tint(){return e()}}}function At(){let[{update:t}]=lt(),e=function(){let t=a(!1);return g((()=>{ft(t)&&ct(t,!1)})),{get nn(){return ft(t)},reset(){ct(t,!0)}}}(),n=d((n=>{let[r,i]=t();return e.nn?0:n+r}),0);return{get value(){return n()},reset(){e.reset()}}}function qt(){let[{update:t}]=lt();return d((e=>{let[n,r]=t();return e+n}),0)}function $t(t){let e=d(C(qt(),((e,n)=>Math.floor(n/t)!==Math.floor(e/t))));return d((t=>e()?t:t+1),0)}function kt(t){let e=C(qt(),(e=>e<=t));return d(C(e,((t,e,n)=>t!==e?t?n+1:-1:t?n+1:n)),0)}function Tt(t,e=!0,n=!1){return d(C(qt(),(r=>r<=t?e:n)))}const Ft=t=>t<.5?2*t*t:(4-2*t)*t-1;function zt(t,e,n,r=Ft){let i=a(e),s=At(),u=d((()=>Math.min(1,s.value/n))),o=d((()=>r(u()))),h=d((()=>t*(1-o())+ft(i)*o())),l=d((()=>1===o()));return{get rn(){return o()},get value(){return h()},set b(t){s.reset(),ct(i,t)},sn:o,un:h,Ee:l}}function It(t){let e=[...Array(t).keys()].map((t=>"!")).join("");return[...Array(10-t).keys()].map((t=>".")).join("")+e}function Ct(t,e){let n=a(t,{equals:!1}),r=d(D(n[0],e));return{get values(){return r()},get head(){return r()[0]},push(t){at(n,(e=>e.push(t)))},Re(t){at(n,(e=>e.unshift(t)))},on(){let t;return at(n,(e=>t=e.shift())),t},remove(t){at(n,(e=>e.splice(e.indexOf(t),1)))},clear(){ct(n,[])}}}const Ut=10;const jt=Math.PI;function Dt(t,e){return function(t,e,n){let r=n-e;return t-r*Math.floor((t-e)/r)}(e-t,-jt,jt)}const Pt=X(),St=t=>[P(Vt,{}),P(Ht,{x:10,y:40,get children(){return P(Ht,{x:1,y:1,scale:2,get children(){return P(Et,{get hn(){return t.ln.status.Ze()}})}})}}),P(Bt,{get Pe(){return t.ln.Pe}}),P(Rt,{get cursor(){return t.ln.cursor}}),P(S,{get M(){return t.ln.Ie},children:t=>P(Ht,{get x(){return t.De.x},get y(){return t.De.y},get children(){return P(Lt,{cn:1,get color(){return t.tint},w:8,vt:8})}})}),P(Ht,{x:2,y:2,get children(){return[P(Lt,{color:4,w:30,vt:9}),P(Ht,{x:1,y:1,get children(){return P(Et,{get hn(){return t.ln.level.Ne()}})}})]}}),P(Ht,{x:200,y:2,get children(){return[P(Lt,{color:4,w:30,vt:9}),P(Ht,{x:1,y:1,get children(){return P(Et,{get hn(){return t.ln.Qe.We()}})}})]}}),P(S,{get M(){return t.ln.Pe.Le},children:t=>P(Ht,{get x(){return t.De.x},get y(){return t.De.y},get children(){return P(Lt,{cn:0,color:0,w:2,vt:2})}})}),P(S,{M:[0,.25,.5,.75,1,1.25,1.5,1.75,2],children:t=>P(Ht,{x:60*t+100,y:160,get children(){return P(Ot,{get angle(){return t*Math.PI}})}})}),P(S,{get M(){return t.ln.Ue},children:t=>P(Ht,{get x(){return t.De.x},get y(){return t.De.y},get children(){return P(Ot,{get angle(){return t.angle+Math.PI/2}})}})})],Ot=t=>{let e=d((()=>(t.angle+2*Math.PI)%(2*Math.PI))),n=d((()=>Math.round(e()/(2*Math.PI/8)))),r=d((()=>n()%2==1)),i=d((()=>Math.floor(n()/2))),s=d((()=>i()*Math.PI/2)),u=d((()=>(r()?Math.PI/4:0)+s())),o=d((()=>s()-Dt(e(),u()))),h=3*Math.random();return P(Ht,{get rotation(){return o()},get pivot(){return H.rt(4,4)},get children(){return P(Jt,{get duration(){return st.te},an:h,frame:3,get fn(){return[0+3*(r()?8:0),32,8,8]}})}})},Rt=t=>P(Ht,{get x(){return t.cursor.De.x},get y(){return t.cursor.De.y},get children(){return[P(Lt,{cn:0,x:-2,y:-2,w:2,vt:2}),P(Lt,{cn:0,w:4,vt:6})]}}),Bt=t=>P(Gt,{get pivot(){return H.rt(15.5,15.5)},get angle(){return t.Pe.angle+Math.PI/2},get x(){return t.Pe.De.x},get y(){return t.Pe.De.y},get frame(){return t.Pe.frame},frames:7,fn:[0,80,31,31]}),Vt=()=>P(Lt,{x:0,y:0,w:320,vt:180}),Et=t=>P(S,{get M(){return t.hn},children:(t,e)=>P(Ht,{get x(){return 4*e()},y:0,get children(){return P(Nt,{get tint(){return t.tint},get fn(){return[16+8*t.frame,16,8,7]}})}})}),Lt=t=>P(Nt,{get fn(){return[0+2*(t.cn??2),0+2*(t.color??0),1,1]},get size(){return H.rt(t.w,t.vt)},get x(){return t.x},get y(){return t.y}}),Gt=t=>{let e=d((()=>(t.angle+2*Math.PI)%(2*Math.PI))),n=d((()=>Math.round(e()/(Math.PI/2)/.5))),r=d((()=>n()%2==1)),i=d((()=>Math.floor(n()/2))),s=d((()=>i()*Math.PI/2)),u=d((()=>(r()?Math.PI/4:0)+s())),o=d((()=>s()-Dt(e(),u())));return P(Ht,{get scale(){return t.scale},get pivot(){return t.pivot},get rotation(){return o()},get x(){return t.x},get y(){return t.y},get tint(){return t.tint},get children(){return P(Kt,{get frame(){return t.frame},get fn(){return[t.fn[0]+(r()?t.fn[2]:0)*t.frames,t.fn[1],t.fn[2],t.fn[3]]}})}})},Ht=t=>(()=>{const e=Pt.clone;return Z(e,(()=>t.children)),f((n=>{const r=t.pivot,i=t.rotation,s=t.tint,u=t.x,o=t.y,h=H.rt(t.scale||1,t.scale||1);return r!==n.gn&&Y(e,"pivot",n.gn=r),i!==n.dn&&Y(e,"rotation",n.dn=i),s!==n.vn&&Y(e,"tint",n.vn=s),u!==n.mn&&Y(e,"x",n.mn=u),o!==n.wn&&Y(e,"y",n.wn=o),h!==n.yn&&Y(e,"scale",n.yn=h),n}),{gn:void 0,dn:void 0,vn:void 0,mn:void 0,wn:void 0,yn:void 0}),e})(),Jt=t=>{const e=function(t,e,n){let r=zt(t,e,n);return g((()=>{r.Ee()&&(r.b=e)})),r}(0,t.frame-1e-4,t.duration),n=d((()=>Math.floor(e.value+(t.an??0))%t.frame));return P(Nt,{get fn(){return[t.fn[0]+n()*t.fn[2],t.fn[1],t.fn[2],t.fn[3]]}})},Kt=t=>P(Nt,{get fn(){return[t.fn[0]+t.frame*t.fn[2],t.fn[1],t.fn[2],t.fn[3]]}}),Nt=t=>{let[{$e:e}]=lt();return(()=>{const n=Pt.clone;return f((r=>{const i=W.rt(e(),...t.fn),s=t.size||H.rt(t.fn[2],t.fn[3]),u=t.tint,o=t.x,h=t.y;return i!==r.pn&&Y(n,"quad",r.pn=i),s!==r.xn&&Y(n,"size",r.xn=s),u!==r._n&&Y(n,"tint",r._n=u),o!==r.Mn&&Y(n,"x",r.Mn=o),h!==r.bn&&Y(n,"y",r.bn=h),r}),{pn:void 0,xn:void 0,_n:void 0,Mn:void 0,bn:void 0}),n})()};function Qt(t){return(e="921dcda6d1bc5ad0.png",new Promise((t=>{let n=new Image;n.onload=()=>t(n),n.src=e}))).then((e=>{let[n,r,i]=((t,e,n,r)=>{let i=new O(t,n,r),s=new Q(i);s.Ft(),s.Bt();let u=new G,o=256e3,{F:h,k:l,It:c,Ct:a,Ut:f}=s.zt("#version 300 es\nin vec3 aTint;\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nout vec2 vTextureCoord;\nout vec3 vTint;\n\nvoid main() {\n  gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0, 1);\n\n  vTextureCoord = aTextureCoord;\n  vTint = aTint;\n}\n","#version 300 es\nprecision highp float;\n\nin vec3 aTint;\nin vec2 vTextureCoord;\nin vec3 vTint;\nout vec4 outColor;\n\nuniform sampler2D uSampler;\n\nvoid main() {\n  //outColor = vec4(1.0, 1.0, 0.0, 1.0);\n  vec4 color = texture(uSampler, vTextureCoord);\n  color.rgb *= vTint;\n  outColor = vec4(color.rgb * color.a, color.a);\n}\n\n",o),g=new Uint16Array(3*o),d=new Float32Array(6*o),{jt:v}=s.jt();return s.Dt(v,e),[(t,e)=>{s.Bt(),s.Pt(h,l);let n=0,r=0,i=0;for(let t=0;t<u.C.length;t++){let e=u.C[t],{D:s,quad:o,tint:h}=e;if(!o)continue;let{yt:l,xt:c}=J.unit.transform(s),{Kt:a,Wt:f}=o,v=N(h);for(let t=0;t<l.length;t+=2)d[n++]=l[t],d[n++]=l[t+1],d[n++]=f[t],d[n++]=f[t+1],d[n++]=v[0],d[n++]=v[1],d[n++]=v[2];for(let t=0;t<c.length;t++)g[r++]=4*i+c[t];i++}let o=!1;for(let t=u.C.length-1;t>=0;t--){let e=u.C[t];o||=e.An?.()}s.Ot(a,d),s.Rt(c,g),s.Vt(6*i,f)},u,i.q]})(t,e,320,180);!function(t,e,n){let r;c((i=>{r=i,Z(e,t(),void 0,n)}))}(((t,e,n,r)=>{let i=()=>{const[{$e:r,root:i,update:s,ke:u,Te:o},{Fe:h,ze:l}]=lt();h(e),l(n),g(C(u,(()=>{i().L(),t()})));let c=new pt;return P(St,{ln:c})};return()=>P(ht,{q:r,get children(){return P(i,{})}})})(n,e,r,i),r)}));var e}return function(t){Qt(t)}}();
